[package]
name = "kalamdb-server"
version.workspace = true
edition.workspace = true
authors.workspace = true
license.workspace = true
repository.workspace = true

[dependencies]
# Core library
kalamdb-core = { path = "crates/kalamdb-core" }
kalamdb-api = { path = "crates/kalamdb-api" }
kalamdb-sql = { path = "crates/kalamdb-sql" }
kalamdb-store = { path = "crates/kalamdb-store" }
kalamdb-commons = { path = "crates/kalamdb-commons" }

# DataFusion for system schema registration
datafusion.workspace = true

# Async runtime
tokio.workspace = true

# Web framework
actix-web.workspace = true
actix-cors.workspace = true

# Configuration
toml.workspace = true

# JWT authentication
jsonwebtoken = "9.2"

# Password hashing
bcrypt = "0.15"

# Random password generation
rand = "0.8"

# Logging
log.workspace = true
env_logger.workspace = true
colored = "3.0.0"
fern = "0.7.1"

# Time handling
chrono.workspace = true

# UUID generation
uuid.workspace = true

# Serialization
serde.workspace = true

# Error handling
anyhow.workspace = true

# System
num_cpus.workspace = true

[lib]
name = "kalamdb_server"
path = "src/lib.rs"

[[bin]]
name = "kalamdb-server"
path = "src/main.rs"

[[test]]
name = "test_shared_tables"
path = "tests/integration/tables/shared/test_shared_tables.rs"

[[test]]
name = "test_user_tables"
path = "tests/integration/tables/user/test_user_tables.rs"

[[test]]
name = "test_stream_tables"
path = "tests/integration/tables/stream/test_stream_tables.rs"

[[test]]
name = "test_quickstart"
path = "tests/integration/combined/test_quickstart.rs"

[[test]]
name = "test_system_tables"
path = "tests/integration/tables/system/test_system_tables.rs"

[[test]]
name = "test_flush_operations"
path = "tests/integration/flush/test_flush_operations.rs"

[[test]]
name = "test_storage_management"
path = "tests/integration/storage_management/test_storage_management.rs"

[[test]]
name = "test_live_query_changes"
path = "tests/integration/combined/test_live_query_changes.rs"

[[test]]
name = "test_manual_flush_verification"
path = "tests/integration/flush/test_manual_flush_verification.rs"

[[test]]
name = "test_namespace_validation"
path = "tests/integration/combined/test_namespace_validation.rs"

[[test]]
name = "test_enhanced_api_features"
path = "tests/integration/api/test_enhanced_api_features.rs"

[[test]]
name = "test_automatic_flushing"
path = "tests/integration/flush/test_automatic_flushing.rs"

[[test]]
name = "test_automatic_flushing_comprehensive"
path = "tests/integration/flush/test_automatic_flushing_comprehensive.rs"

# [[test]]
# name = "test_schema_integrity"
# path = "tests/integration/combined/test_schema_integrity.rs"

[[test]]
name = "test_stress_and_memory"
path = "tests/integration/combined/test_stress_and_memory.rs"

[[test]]
name = "test_row_count_behavior"
path = "tests/test_row_count_behavior.rs"

[[test]]
name = "test_basic_auth"
path = "tests/test_basic_auth.rs"

[dev-dependencies]
tempfile = "3"
serde_json.workspace = true
actix-http = "3.4"
tokio-tungstenite = "0.21"
futures-util = "0.3"
uuid.workspace = true
rocksdb.workspace = true
base64 = "0.21"
bcrypt = "0.15"
