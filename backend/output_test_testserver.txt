   Compiling kalamdb-server v0.2.0 (/Users/jamal/git/KalamDB/backend)
warning: unused import: `tokio::time::Duration`
 --> backend/tests/testserver/tables/test_stream_tables_http.rs:5:5
  |
5 | use tokio::time::Duration;
  |     ^^^^^^^^^^^^^^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: unused import: `tokio::time::Duration`
  --> backend/tests/testserver/storage/test_storage_management_http.rs:11:5
   |
11 | use tokio::time::Duration;
   |     ^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `super::test_support::http_server::HttpTestServer`
 --> backend/tests/testserver/subscription/test_stream_ttl_eviction_sql.rs:8:5
  |
8 | use super::test_support::http_server::HttpTestServer;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `futures_util::StreamExt`
 --> backend/tests/testserver/subscription/test_live_query_inserts.rs:4:5
  |
4 | use futures_util::StreamExt;
  |     ^^^^^^^^^^^^^^^^^^^^^^^

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?
    = note: `#[warn(unused_assignments)]` (part of `#[warn(unused)]`) on by default

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/tables/../../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/sql/../../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/system/../../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/flush/../../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/storage/../../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/manifest/../../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/subscription/../../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?

warning: unused variable: `rows`
  --> backend/tests/testserver/subscription/test_live_query_inserts.rs:66:51
   |
66 |                     Some(Ok(ChangeEvent::Insert { rows, .. })) => {
   |                                                   ^^^^ help: try ignoring the field: `rows: _`
   |
   = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: variable does not need to be mutable
  --> backend/tests/testserver/subscription/test_live_query_deletes.rs:52:9
   |
52 |     let mut timeout = tokio::time::sleep(Duration::from_secs(5));
   |         ----^^^^^^^
   |         |
   |         help: remove this `mut`
   |
   = note: `#[warn(unused_mut)]` (part of `#[warn(unused)]`) on by default

warning: variable does not need to be mutable
  --> backend/tests/testserver/subscription/test_live_query_deletes.rs:84:9
   |
84 |     let mut timeout = tokio::time::sleep(Duration::from_secs(5));
   |         ----^^^^^^^
   |         |
   |         help: remove this `mut`

warning: value assigned to `delete_received` is never read
  --> backend/tests/testserver/subscription/test_live_query_deletes.rs:83:31
   |
83 |     let mut delete_received = false;
   |                               ^^^^^
   |
   = help: maybe it is overwritten before being read?

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/observability/../../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/stress/../../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?

warning: value assigned to `last_error` is never read
   --> backend/tests/testserver/cluster/../../common/testserver/http_server.rs:488:46
    |
488 |         let mut last_error: Option<String> = None;
    |                                              ^^^^
    |
    = help: maybe it is overwritten before being read?

warning: struct `ClusterTestServer` is never constructed
 --> backend/tests/testserver/../common/testserver/cluster.rs:8:12
  |
8 | pub struct ClusterTestServer {
  |            ^^^^^^^^^^^^^^^^^
  |
  = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: multiple associated items are never used
   --> backend/tests/testserver/../common/testserver/cluster.rs:17:12
    |
 15 | impl ClusterTestServer {
    | ---------------------- associated items in this implementation
 16 |     /// Get a reference to a node in the cluster (0, 1, or 2)
 17 |     pub fn get_node(&self, index: usize) -> Result<&HttpTestServer> {
    |            ^^^^^^^^
...
 24 |     pub async fn is_node_online(&self, index: usize) -> Result<bool> {
    |                  ^^^^^^^^^^^^^^
...
 33 |     pub async fn wait_for_node_online(&self, index: usize) -> Result<()> {
    |                  ^^^^^^^^^^^^^^^^^^^^
...
 47 |     pub async fn take_node_offline(&self, index: usize) -> Result<()> {
    |                  ^^^^^^^^^^^^^^^^^
...
 59 |     pub async fn bring_node_online(&self, index: usize) -> Result<()> {
    |                  ^^^^^^^^^^^^^^^^^
...
 71 |     pub async fn execute_sql_on_random(&self, sql: &str) -> Result<QueryResponse> {
    |                  ^^^^^^^^^^^^^^^^^^^^^
...
 95 |     pub async fn execute_sql_on_all(&self, sql: &str) -> Result<Vec<QueryResponse>> {
    |                  ^^^^^^^^^^^^^^^^^^
...
108 |     pub async fn execute_sql_on_all_with_indices(
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
...
124 |     pub async fn verify_data_consistency(&self, query: &str) -> Result<bool> {
    |                  ^^^^^^^^^^^^^^^^^^^^^^^
...
185 |     pub fn new(nodes: Vec<HttpTestServer>) -> Self {
    |            ^^^

warning: function `is_pending_job_status` is never used
 --> backend/tests/testserver/../common/testserver/flush.rs:8:4
  |
8 | fn is_pending_job_status(status: &str) -> bool {
  |    ^^^^^^^^^^^^^^^^^^^^^

warning: function `wait_for_flush_jobs_settled` is never used
  --> backend/tests/testserver/../common/testserver/flush.rs:13:14
   |
13 | pub async fn wait_for_flush_jobs_settled(
   |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: function `flush_table_and_wait` is never used
  --> backend/tests/testserver/../common/testserver/flush.rs:79:14
   |
79 | pub async fn flush_table_and_wait(server: &HttpTestServer, ns: &str, table: &str) -> Result<()> {
   |              ^^^^^^^^^^^^^^^^^^^^

warning: function `find_parquet_files` is never used
   --> backend/tests/testserver/../common/testserver/flush.rs:101:8
    |
101 | pub fn find_parquet_files(root: &Path) -> Vec<PathBuf> {
    |        ^^^^^^^^^^^^^^^^^^

warning: function `count_parquet_files_for_table` is never used
   --> backend/tests/testserver/../common/testserver/flush.rs:122:8
    |
122 | pub fn count_parquet_files_for_table(storage_root: &Path, ns: &str, table: &str) -> usize {
    |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: function `wait_for_parquet_files_for_table` is never used
   --> backend/tests/testserver/../common/testserver/flush.rs:133:14
    |
133 | pub async fn wait_for_parquet_files_for_table(
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: function `wait_for_parquet_files_for_user_table` is never used
   --> backend/tests/testserver/../common/testserver/flush.rs:173:14
    |
173 | pub async fn wait_for_parquet_files_for_user_table(
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: static `GLOBAL_CLUSTER_SERVER` is never used
  --> backend/tests/testserver/../common/testserver/http_server.rs:31:8
   |
31 | static GLOBAL_CLUSTER_SERVER: OnceCell<ClusterTestServer> = OnceCell::const_new();
   |        ^^^^^^^^^^^^^^^^^^^^^

warning: function `get_cluster_server` is never used
  --> backend/tests/testserver/../common/testserver/http_server.rs:73:14
   |
73 | pub async fn get_cluster_server() -> &'static ClusterTestServer {
   |              ^^^^^^^^^^^^^^^^^^

warning: fields `jwt_secret` and `user_id_cache` are never read
  --> backend/tests/testserver/../common/testserver/http_server.rs:94:5
   |
84 | pub struct HttpTestServer {
   |            -------------- fields in this struct
...
94 |     jwt_secret: String,
   |     ^^^^^^^^^^
...
98 |     user_id_cache: std::sync::Mutex<HashMap<String, String>>,
   |     ^^^^^^^^^^^^^

warning: multiple methods are never used
   --> backend/tests/testserver/../common/testserver/http_server.rs:184:12
    |
133 | impl HttpTestServer {
    | ------------------- methods in this implementation
...
184 |     pub fn websocket_url(&self) -> String {
    |            ^^^^^^^^^^^^^
...
194 |     pub fn create_jwt_token_with_id(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
...
215 |     pub fn create_jwt_token(&self, username: &UserName) -> String {
    |            ^^^^^^^^^^^^^^^^
...
243 |     pub fn cache_user_id(&self, username: &str, user_id: &str) {
    |            ^^^^^^^^^^^^^
...
249 |     pub fn get_cached_user_id(&self, username: &str) -> Option<String> {
    |            ^^^^^^^^^^^^^^^^^^
...
255 |     async fn ensure_user_exists(
    |              ^^^^^^^^^^^^^^^^^^
...
300 |     pub fn link_client_with_id(
    |            ^^^^^^^^^^^^^^^^^^^
...
332 |     pub fn link_client(&self, username: &str) -> KalamLinkClient {
    |            ^^^^^^^^^^^
...
357 |     pub async fn execute_sql_with_params(
    |                  ^^^^^^^^^^^^^^^^^^^^^^^

warning: struct `ClusterTestServer` is never constructed
   --> backend/tests/testserver/../common/testserver/http_server.rs:779:12
    |
779 | pub struct ClusterTestServer {
    |            ^^^^^^^^^^^^^^^^^

warning: methods `get_node`, `execute_sql_on_random`, `execute_sql_on_all`, and `verify_data_consistency` are never used
   --> backend/tests/testserver/../common/testserver/http_server.rs:786:12
    |
784 | impl ClusterTestServer {
    | ---------------------- methods in this implementation
785 |     /// Get a reference to a node in the cluster (0, 1, or 2)
786 |     pub fn get_node(&self, index: usize) -> Result<&HttpTestServer> {
    |            ^^^^^^^^
...
793 |     pub async fn execute_sql_on_random(&self, sql: &str) -> Result<QueryResponse> {
    |                  ^^^^^^^^^^^^^^^^^^^^^
...
801 |     pub async fn execute_sql_on_all(&self, sql: &str) -> Result<Vec<QueryResponse>> {
    |                  ^^^^^^^^^^^^^^^^^^
...
810 |     pub async fn verify_data_consistency(&self, query: &str) -> Result<bool> {
    |                  ^^^^^^^^^^^^^^^^^^^^^^^

warning: function `start_cluster_server` is never used
   --> backend/tests/testserver/../common/testserver/http_server.rs:875:10
    |
875 | async fn start_cluster_server() -> Result<ClusterTestServer> {
    |          ^^^^^^^^^^^^^^^^^^^^

warning: function `is_pending_job_status` is never used
 --> backend/tests/testserver/../common/testserver/jobs.rs:7:4
  |
7 | fn is_pending_job_status(status: &str) -> bool {
  |    ^^^^^^^^^^^^^^^^^^^^^

warning: function `extract_cleanup_job_id` is never used
  --> backend/tests/testserver/../common/testserver/jobs.rs:14:8
   |
14 | pub fn extract_cleanup_job_id(message: &str) -> Option<String> {
   |        ^^^^^^^^^^^^^^^^^^^^^^

warning: function `wait_for_job_completion` is never used
  --> backend/tests/testserver/../common/testserver/jobs.rs:19:14
   |
19 | pub async fn wait_for_job_completion(
   |              ^^^^^^^^^^^^^^^^^^^^^^^

warning: function `wait_for_path_absent` is never used
  --> backend/tests/testserver/../common/testserver/jobs.rs:72:14
   |
72 | pub async fn wait_for_path_absent(path: &std::path::Path, timeout: Duration) -> bool {
   |              ^^^^^^^^^^^^^^^^^^^^

warning: `kalamdb-server` (test "test_testserver") generated 39 warnings (run `cargo fix --test "test_testserver" -p kalamdb-server` to apply 6 suggestions)
    Finished `test` profile [unoptimized] target(s) in 7.08s
warning: the following packages contain code that will be rejected by a future version of Rust: num-bigint-dig v0.8.4
note: to see what the problems were, use the option `--future-incompat-report`, or run `cargo report future-incompatibilities --id 1`
     Running tests/testserver/test_testserver.rs (/Users/jamal/git/KalamDB/target/debug/deps/test_testserver-8e1e73564ce80f83)

running 27 tests
test flush::test_flush_jobs_http::test_flush_table_persists_job_over_http ... FAILED
test cluster::test_cluster_commands_http::test_cluster_commands_over_http has been running for over 60 seconds
test cluster::test_cluster_snapshots_http::test_cluster_snapshot_creation_and_reuse has been running for over 60 seconds
test cluster::test_cluster_views_http::test_system_cluster_views_over_http has been running for over 60 seconds
test flush::test_flush_policy_verification_http::test_flush_policy_and_parquet_output_over_http has been running for over 60 seconds
test flush::test_flush_unregistered_suite_http::test_flush_concurrency_and_correctness_over_http has been running for over 60 seconds
test flush::test_pk_uniqueness_hot_cold_http::test_pk_uniqueness_hot_and_cold_over_http has been running for over 60 seconds
test manifest::test_manifest_flush_http_v2::test_shared_flush_creates_manifest_json_over_http has been running for over 60 seconds
test manifest::test_manifest_persistence_http::test_user_table_manifest_persistence_over_http has been running for over 60 seconds
test observability::test_production_observability_http::test_observability_system_tables_and_jobs_over_http has been running for over 60 seconds
test cluster::test_cluster_views_http::test_system_cluster_views_over_http ... FAILED
test cluster::test_cluster_commands_http::test_cluster_commands_over_http ... FAILED
test observability::test_production_observability_http::test_observability_system_tables_and_jobs_over_http ... FAILED
test sql::test_dml_parameters_http::test_parameterized_dml_over_http has been running for over 60 seconds
test sql::test_namespace_validation_http::test_namespace_validation_over_http has been running for over 60 seconds
test sql::test_naming_validation_http::test_naming_validation_over_http has been running for over 60 seconds
test cluster::test_cluster_snapshots_http::test_cluster_snapshot_creation_and_reuse ... FAILED
test sql::test_quickstart_http::test_quickstart_workflow_over_http has been running for over 60 seconds
test sql::test_naming_validation_http::test_naming_validation_over_http ... FAILED
test sql::test_namespace_validation_http::test_namespace_validation_over_http ... FAILED
test sql::test_quickstart_http::test_quickstart_workflow_over_http ... FAILED
test sql::test_dml_parameters_http::test_parameterized_dml_over_http ... FAILED
test flush::test_flush_unregistered_suite_http::test_flush_concurrency_and_correctness_over_http ... FAILED
test flush::test_flush_policy_verification_http::test_flush_policy_and_parquet_output_over_http ... FAILED
test flush::test_pk_uniqueness_hot_cold_http::test_pk_uniqueness_hot_and_cold_over_http ... FAILED
test sql::test_user_sql_commands_http::test_user_sql_commands_over_http has been running for over 60 seconds
test sql::test_user_sql_commands_http::test_user_sql_commands_over_http ... FAILED
test storage::test_storage_abstraction_http::test_storage_abstraction_over_http has been running for over 60 seconds
test storage::test_storage_management_http::test_storage_management_over_http has been running for over 60 seconds
test stress::test_stress_and_memory_http::test_stress_smoke_over_http has been running for over 60 seconds
test subscription::test_live_query_deletes::test_live_query_detects_deletes has been running for over 60 seconds
test subscription::test_live_query_inserts::test_live_query_detects_inserts has been running for over 60 seconds
test subscription::test_live_query_updates::test_live_query_detects_updates has been running for over 60 seconds
test subscription::test_stream_ttl_eviction_sql::test_stream_ttl_eviction_from_sql_script has been running for over 60 seconds
test system::test_system_tables_http::test_system_tables_queryable_over_http has been running for over 60 seconds
